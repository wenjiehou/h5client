var tape=require("tape"),pool=require("..");tape.test("pool",function(e){var a=pool(function(e){return new Uint8Array(e)},Uint8Array.prototype.subarray),f=a(0);e.equal(f.length,0,"should allocate a buffer of size 0");var t=a(1);e.equal(t.length,1,"should allocate a buffer of size 1 (initializes slab)"),e.notEqual(t.buffer,f.buffer,"should not reference the same backing buffer if previous buffer had size 0"),e.equal(t.byteOffset,0,"should allocate at byteOffset 0 when using a new slab"),f=a(1),e.equal(f.buffer,t.buffer,"should reference the same backing buffer when allocating a chunk fitting into the slab"),e.equal(f.byteOffset,8,"should align slices to 32 bit and this allocate at byteOffset 8");var r=a(4097);e.notEqual(r.buffer,t.buffer,"should not reference the same backing buffer when allocating a buffer larger than half the backing buffer's size"),t=a(4096),e.equal(t.buffer,f.buffer,"should reference the same backing buffer when allocating a buffer smaller or equal than half the backing buffer's size"),f=a(4096),e.notEqual(f.buffer,t.buffer,"should not reference the same backing buffer when the slab is exhausted (initializes new slab)"),e.end()});
var tape=require("tape"),protobuf=require(".."),proto="message A {    required uint32 a = 1;}message B {    required string b = 1;}";tape.test("reusing",function(e){var a=protobuf.parse(proto).root,r=a.lookup("A"),t=a.lookup("B");e.test(e.name+" - a writer should write",function(e){var a=protobuf.Writer.create();r.encodeDelimited({a:1},a),t.encodeDelimited({b:"a"},a);var o=a.finish();e.equal(o[0],2,"length 2"),e.equal(o[1],8,"id 1, wireType 0"),e.equal(o[2],1,"number 1"),e.equal(o[3],3,"length 3"),e.equal(o[4],10,"id 1, wireType 2"),e.equal(o[5],1,"length 1"),e.equal(o[6],97,"string 'a'");var i=protobuf.Reader.create(o);e.test(e.name+" - and a reader should",function(e){var a=r.decodeDelimited(i);e.deepEqual(a,{a:1},"read back the first message");var o=t.decodeDelimited(i);e.deepEqual(o,{b:"a"},"read back the second message"),e.equal(i.pos,i.len,"consume the reader"),e.end()}),e.end()}),e.end()});
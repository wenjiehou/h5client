"use strict";function basenameCompare(e,r){for(var t=String(e).replace(/\.\w+$/,"").split(/(-?\d*\.?\d+)/g),n=String(r).replace(/\.\w+$/,"").split(/(-?\d*\.?\d+)/g),s=0,o=Math.min(t.length,n.length);s<o;s++){var a=parseFloat(t[s])||t[s].toLowerCase(),i=parseFloat(n[s])||n[s].toLowerCase();if(a<i)return-1;if(a>i)return 1}return e.length<r.length?-1:0}function modExists(e,r){for(var t=0;t<module.paths.length;++t)try{var n=JSON.parse(fs.readFileSync(path.join(module.paths[t],e,"package.json")));return semver?semver.satisfies(n.version,r):parseInt(n.version,10)===parseInt(r.replace(/^[\^~]/,""),10)}catch(e){}return!1}function modInstall(e){child_process.execSync("npm --silent install "+("string"==typeof e?e:e.join(" ")),{cwd:__dirname,stdio:"ignore"})}var semver,fs=require("fs"),path=require("path"),child_process=require("child_process");try{require.resolve("protobufjs"),exports.pathToProtobufJs="protobufjs"}catch(e){exports.pathToProtobufJs=".."}var protobuf=require(exports.pathToProtobufJs);exports.requireAll=function(e){e=path.join(__dirname,e);var r={};return fs.readdirSync(e).sort(basenameCompare).forEach(function(t){var n=path.basename(t,".js");".js"===path.extname(t)&&(r[n]=require(path.join(e,t)))}),r},exports.traverse=function e(r,t){t(r),r.fieldsArray&&r.fieldsArray.forEach(function(r){e(r,t)}),r.oneofsArray&&r.oneofsArray.forEach(function(r){e(r,t)}),r.methodsArray&&r.methodsArray.forEach(function(r){e(r,t)}),r.nestedArray&&r.nestedArray.forEach(function(r){e(r,t)})},exports.traverseResolved=function e(r,t){t(r),r.resolvedType&&e(r.resolvedType,t),r.resolvedKeyType&&e(r.resolvedKeyType,t),r.resolvedRequestType&&e(r.resolvedRequestType,t),r.resolvedResponseType&&e(r.resolvedResponseType,t)},exports.inspect=function e(r,t){if(!r)return"";var n=require("chalk"),s=[];t||(t="");var o=t?t.substring(0,t.length-2)+"â”” ":"";return s.push(o+n.bold(r.toString())+(r.visible?" (visible)":""),t+n.gray("parent: ")+r.parent),r instanceof protobuf.Field&&(void 0!==r.extend&&s.push(t+n.gray("extend: ")+r.extend),r.partOf&&s.push(t+n.gray("oneof : ")+r.oneof)),s.push(""),r.fieldsArray&&r.fieldsArray.forEach(function(r){s.push(e(r,t+"  "))}),r.oneofsArray&&r.oneofsArray.forEach(function(r){s.push(e(r,t+"  "))}),r.methodsArray&&r.methodsArray.forEach(function(r){s.push(e(r,t+"  "))}),r.nestedArray&&r.nestedArray.forEach(function(r){s.push(e(r,t+"  "))}),s.join("\n")},exports.setup=function(){var e=require(path.join(__dirname,"..","package.json")),r=e.dependencies.semver||e.devDependencies.semver;modExists("semver",r)||(process.stderr.write("installing semver@"+r+"\n"),modInstall("semver@"+r)),semver=require("semver");var t=[];e.cliDependencies.forEach(function(n){"semver"!==n&&(modExists(n,r=e.dependencies[n]||e.devDependencies[n])||(process.stderr.write("installing "+n+"@"+r+"\n"),t.push(n+"@"+r)))}),require("../scripts/postinstall"),t.length&&modInstall(t)},exports.wrap=function(e,r){var t,n=r.wrap||"default";try{t=fs.readFileSync(path.join(__dirname,"wrappers",n+".js")).toString("utf8")}catch(e){t=fs.readFileSync(path.resolve(process.cwd(),n)).toString("utf8")}return t=t.replace(/\$DEPENDENCY/g,JSON.stringify(r.dependency||"protobufjs")),t=t.replace(/( *)\$OUTPUT;/,function(r,t){return t.length?e.replace(/^/gm,t):e}),""!==r.lint&&(t="/*"+r.lint+"*/\n"+t),t.replace(/\r?\n/g,"\n")},exports.pad=function(e,r,t){for(;e.length<r;)e=t?e+" ":" "+e;return e},exports.reserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},exports.safeProp=protobuf.util.safeProp=function(e){return function(r){return!/^[$\w]+$/.test(r)||exports.reserved(r)?e(r):"."+r}}(protobuf.util.safeProp),exports.jsonSafeProp=function(e){return e.replace(/^( +)"(\w+)":/gm,function(e,r,t){return"."===exports.safeProp(t).charAt(0)?r+t+":":e})};